data(fl25)
data('algdat.p10')
plans <- algdat.p10$cdmat[, 1:2]

test_that('compactness works', {
  comp <- redist.compactness(
    shp = fl25, plans = plans,
    measure = 'all', total_pop = fl25$pop,
    counties = rep(1, 25)
  )
  expectation <- structure(list(
    districts = c(1L, 2L, 3L, 1L, 2L, 3L), PolsbyPopper = c(
      0.280974171635904,
      0.251305320317832, 0.321576424326112, 0.394022094408393, 0.251305320317832,
      0.223058240647923
    ), Schwartzberg = c(
      1.88654339840818, 1.99479907650341,
      1.76342867705533, 1.59308780238445, 1.99479907650341, 2.11734127572223
    ), LengthWidth = c(
      0.926285160038819, 0.653935724266415, 0.404149212048674,
      0.874431619447365, 0.653935724266415, 0.417276720351394
    ), ConvexHull = c(
      0.688881302064472,
      0.657235285584772, 0.69658418758615, 0.724528346382631, 0.657235285584772,
      0.598835368827764
    ), Reock = c(
      0.434309475795215, 0.306636855862773,
      0.224687815036725, 0.424621673380866, 0.306636855862773, 0.210884919736818
    ), BoyceClark = c(
      0.855392779807052, 0.750250900412383, 0.735085159873138,
      0.832201015045522, 0.750250900412383, 0.804636547547239
    ), FryerHolden = c(
      131124756.627412,
      131124756.627412, 131124756.627412, 105282505.012801, 105282505.012801,
      105282505.012801
    ), EdgesRemoved = c(32, 32, 32, 32, 32, 32),
    FracKept = c(
      0.372549019607843, 0.372549019607843, 0.372549019607843,
      0.372549019607843, 0.372549019607843, 0.372549019607843
    ),
    logSpanningTree = c(
      12.6907185515128, 12.6907185515128, 12.6907185515128,
      12.6907185515128, 12.6907185515128, 12.6907185515128
    ), nloop = c(
      1,
      1, 1, 2, 2, 2
    )
  ), row.names = c(NA, -6L), class = c(
    'tbl_df',
    'tbl', 'data.frame'
  ))
  expect_equal(comp, expectation)
})
