plans <- plans_10[, 1:2]

test_that('compactness works', {
  comp <- redist.compactness(
    shp = fl25, plans = plans,
    measure = 'all', total_pop = pop,
    counties = rep(1, 25)
  )
  expected <- structure(list(district = c(1L, 2L, 3L, 1L, 2L, 3L), PolsbyPopper = c(
    0.285483107297663,
    0.24580015313474, 0.336569986590111, 0.397349350947363, 0.24580015313474,
    0.234777825214489
  ), Schwartzberg = c(
    1.8715860196228, 2.01701405944745,
    1.72370248320153, 1.58640381656857, 2.01701405944745, 2.06381831553643
  ), LengthWidth = c(
    0.828647781811625, 0.584669038360596, 0.451674302125593,
    0.977715844325043, 0.584669038360596, 0.466277810572328
  ), ConvexHull = c(
    0.688768241406508,
    0.657231477694212, 0.696695943825318, 0.724415257739837, 0.657231477694212,
    0.598864141784943
  ), Reock = c(
    0.417899595060334, 0.282322040019801,
    0.248623776068927, 0.426992057151342, 0.282322040019801, 0.228377042338303
  ), BoyceClark = c(
    0.82772643618323, 0.748621124728932, 0.739263135944462,
    0.820144195316791, 0.748621124728932, 0.808369841656909
  ), FryerHolden = c(
    1.840160734482e+18,
    1.840160734482e+18, 1.840160734482e+18, 1493554672544877824,
    1493554672544877824, 1493554672544877824
  ), EdgesRemoved = c(
    32,
    32, 32, 32, 32, 32
  ), FracKept = c(
    0.372549019607843, 0.372549019607843,
    0.372549019607843, 0.372549019607843, 0.372549019607843, 0.372549019607843
  ), logSpanningTree = c(
    12.6907185515128, 12.6907185515128, 12.6907185515128,
    12.6907185515128, 12.6907185515128, 12.6907185515128
  ), nloop = c(
    1,
    1, 1, 2, 2, 2
  )), row.names = c(NA, -6L), class = c(
    'tbl_df',
    'tbl', 'data.frame'
  ))

  expect_equal(comp, expected)
})


test_that('test prep polsbypopper works', {
  test <- redist.prep.polsbypopper(shp = fl25)

  expect_s3_class(test, class = 'data.frame')
})
