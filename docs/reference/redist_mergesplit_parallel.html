<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Parallel Merge-Split/Recombination MCMC Redistricting Sampler — redist_mergesplit_parallel • redist</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Parallel Merge-Split/Recombination MCMC Redistricting Sampler — redist_mergesplit_parallel"><meta property="og:description" content="redist_mergesplit_parallel() runs redist_mergesplit() on several
chains in parallel."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">redist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/redist.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/common_args.html">Common Arguments to `redist` Functions</a>
    </li>
    <li>
      <a href="../articles/map-preproc.html">Map Pre-processing for Special Constraints</a>
    </li>
    <li>
      <a href="../articles/mcmc.html">Redistricting with Flip MCMC</a>
    </li>
    <li>
      <a href="../articles/mpi-slurm.html">MPI / Slurm Sample Scripts</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Releases</li>
    <li>
      <a href="https://alarm-redist.github.io/posts/2021-04-02-redist-300/" class="external-link">redist 3.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alarm-redist/redist/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Parallel Merge-Split/Recombination MCMC Redistricting Sampler</h1>
    <small class="dont-index">Source: <a href="https://github.com/alarm-redist/redist/blob/HEAD/R/redist_ms_parallel.R" class="external-link"><code>R/redist_ms_parallel.R</code></a></small>
    <div class="hidden name"><code>redist_mergesplit_parallel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>redist_mergesplit_parallel()</code> runs <code><a href="redist_mergesplit.html">redist_mergesplit()</a></code> on several
chains in parallel.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">redist_mergesplit_parallel</span><span class="op">(</span>
  <span class="va">map</span>,
  <span class="va">nsims</span>,
  chains <span class="op">=</span> <span class="fl">1</span>,
  warmup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">nsims</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span><span class="fl">2</span><span class="op">)</span>,
  thin <span class="op">=</span> <span class="fl">1L</span>,
  init_plan <span class="op">=</span> <span class="cn">NULL</span>,
  counties <span class="op">=</span> <span class="cn">NULL</span>,
  compactness <span class="op">=</span> <span class="fl">1</span>,
  constraints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  constraint_fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span>,
  adapt_k_thresh <span class="op">=</span> <span class="fl">0.98</span>,
  k <span class="op">=</span> <span class="cn">NULL</span>,
  ncores <span class="op">=</span> <span class="cn">NULL</span>,
  cl_type <span class="op">=</span> <span class="st">"PSOCK"</span>,
  return_all <span class="op">=</span> <span class="cn">TRUE</span>,
  init_name <span class="op">=</span> <span class="cn">NULL</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>,
  silent <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>map</dt>
<dd><p>A <code><a href="redist_map.html">redist_map</a></code> object.</p></dd>
<dt>nsims</dt>
<dd><p>The number of samples to draw, including warmup.</p></dd>
<dt>chains</dt>
<dd><p>the number of parallel chains to run. Each chain will have
<code>nsims</code> draws. If <code>init_plan</code> is sampled, each chain will be initialized
with its own sampled plan.</p></dd>
<dt>warmup</dt>
<dd><p>The number of warmup samples to discard. Recommended to be at
least the first 20% of samples, and in any case no less than around 100
samples.</p></dd>
<dt>thin</dt>
<dd><p>Save every <code>thin</code>-th sample. Defaults to no thinning (1).</p></dd>
<dt>init_plan</dt>
<dd><p>The initial state of the map, provided as a single vector
to be shared across all chains, or a matrix with <code>chains</code> columns.
If not provided, will default to the reference map of the map object, or if
none exists, will sample a random initial state using redist_smc. You can
also request a random initial state for each chain by setting
init_plan="sample".</p></dd>
<dt>counties</dt>
<dd><p>A vector containing county (or other administrative or
geographic unit) labels for each unit, which may be integers ranging from 1
to the number of counties, or a factor or character vector.  If provided,
the algorithm will generate maps tend to follow county lines. There is no
strength parameter associated with this constraint. To adjust the number of
county splits further, or to constrain a second type of administrative
split, consider using <code><a href="constraints.html">add_constr_splits()</a></code>, <code><a href="constraints.html">add_constr_multisplits()</a></code>,
and <code><a href="constraints.html">add_constr_total_splits()</a></code>.</p></dd>
<dt>compactness</dt>
<dd><p>Controls the compactness of the generated districts, with
higher values preferring more compact districts. Must be nonnegative. See the
'Details' section for more information, and computational considerations.</p></dd>
<dt>constraints</dt>
<dd><p>A list containing information on constraints to implement.
See the 'Details' section for more information.</p></dd>
<dt>constraint_fn</dt>
<dd><p>A function which takes in a matrix where each column is
a redistricting plan and outputs a vector of log-weights, which will be
added the the final weights.</p></dd>
<dt>adapt_k_thresh</dt>
<dd><p>The threshold value used in the heuristic to select a
value <code>k_i</code> for each splitting iteration. Set to 0.9999 or 1 if
the algorithm does not appear to be sampling from the target distribution.
Must be between 0 and 1.</p></dd>
<dt>k</dt>
<dd><p>The number of edges to consider cutting after drawing a spanning
tree. Should be selected automatically in nearly all cases.</p></dd>
<dt>ncores</dt>
<dd><p>the number of parallel processes to run. Defaults to the
maximum available.</p></dd>
<dt>cl_type</dt>
<dd><p>the cluster type (see <code>makeCluster()</code>). Safest is <code>"PSOCK"</code>,
but <code>"FORK"</code> may be appropriate in some settings.</p></dd>
<dt>return_all</dt>
<dd><p>if <code>TRUE</code> return all sampled plans; otherwise, just return
the final plan from each chain.</p></dd>
<dt>init_name</dt>
<dd><p>a name for the initial plan, or <code>FALSE</code> to not include
the initial plan in the output.  Defaults to the column name of the
existing plan, or "<code>&lt;init&gt;</code>" if the initial plan is sampled.</p></dd>
<dt>verbose</dt>
<dd><p>Whether to print out intermediate information while sampling.
Recommended.</p></dd>
<dt>silent</dt>
<dd><p>Whether to suppress all diagnostic information.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code><a href="redist_plans.html">redist_plans</a></code> object with all of the simulated plans, and an
additional <code>chain</code> column indicating the chain the plan was drawn from.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function draws samples from a specific target measure, controlled by the
<code>map</code>, <code>compactness</code>, and <code>constraints</code> parameters.</p>
<p>Key to ensuring good performance is monitoring the acceptance rate, which
is reported at the sample level in the output.
Users should also check diagnostics of the sample by running
<code><a href="summary.redist_plans.html">summary.redist_plans()</a></code>.</p>
<p>Higher values of <code>compactness</code> sample more compact districts;
setting this parameter to 1 is computationally efficient and generates nicely
compact districts.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Carter, D., Herschlag, G., Hunter, Z., and Mattingly, J. (2019). A
merge-split proposal for reversible Monte Carlo Markov chain sampling of
redistricting plans. arXiv preprint arXiv:1911.01503.</p>
<p>DeFord, D., Duchin, M., and Solomon, J. (2019). Recombination: A family of
Markov chains for redistricting. arXiv preprint arXiv:1911.05725.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fl25</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fl_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="redist_map.html">redist_map</a></span><span class="op">(</span><span class="va">fl25</span>, ndists <span class="op">=</span> <span class="fl">3</span>, pop_tol <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sampled</span> <span class="op">&lt;-</span> <span class="fu">redist_mergesplit_parallel</span><span class="op">(</span><span class="va">fl_map</span>, nsims <span class="op">=</span> <span class="fl">100</span>, chains <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christopher T. Kenny, Cory McCartan, Ben Fifield, Kosuke Imai.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

