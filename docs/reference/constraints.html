<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sampling constraints — add_constr_status_quo • redist</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sampling constraints — add_constr_status_quo" />
<meta property="og:description" content="The redist_smc() and redist_mergesplit() algorithms in this package allow
for additional constraints on the redistricting process to be encoded in the
target distribution for sampling. These functions are provided to specify
these constraints. All arguments are quoted and evaluated in the context of
the data frame provided to redist_constr()." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">redist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/redist.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/glossary.html">Glossary of Key Redistricting Terms</a>
    </li>
    <li>
      <a href="../articles/map-preproc.html">Map Pre-processing for Special Constraints</a>
    </li>
    <li>
      <a href="../articles/mcmc.html">Redistricting with Flip MCMC</a>
    </li>
    <li>
      <a href="../articles/mpi-slurm.html">MPI / Slurm Sample Scripts</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Releases</li>
    <li>
      <a href="https://alarm-redist.github.io/posts/2021-04-02-redist-300/">redist 3.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alarm-redist/redist/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sampling constraints</h1>
    <small class="dont-index">Source: <a href='https://github.com/alarm-redist/redist/blob/master/R/redist_constr.R'><code>R/redist_constr.R</code></a></small>
    <div class="hidden name"><code>constraints.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code><a href='redist_smc.html'>redist_smc()</a></code> and <code><a href='redist_mergesplit.html'>redist_mergesplit()</a></code> algorithms in this package allow
for additional constraints on the redistricting process to be encoded in the
target distribution for sampling. These functions are provided to specify
these constraints. All arguments are quoted and evaluated in the context of
the data frame provided to <code><a href='redist_constr.html'>redist_constr()</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>add_constr_status_quo</span><span class='op'>(</span><span class='va'>constr</span>, <span class='va'>strength</span>, <span class='va'>current</span><span class='op'>)</span>

<span class='fu'>add_constr_grp_pow</span><span class='op'>(</span>
  <span class='va'>constr</span>,
  <span class='va'>strength</span>,
  <span class='va'>group_pop</span>,
  total_pop <span class='op'>=</span> <span class='cn'>NULL</span>,
  tgt_group <span class='op'>=</span> <span class='fl'>0.5</span>,
  tgt_other <span class='op'>=</span> <span class='fl'>0.5</span>,
  pow <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span>

<span class='fu'>add_constr_grp_hinge</span><span class='op'>(</span>
  <span class='va'>constr</span>,
  <span class='va'>strength</span>,
  <span class='va'>group_pop</span>,
  total_pop <span class='op'>=</span> <span class='cn'>NULL</span>,
  tgts_group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.55</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'>add_constr_compet</span><span class='op'>(</span><span class='va'>constr</span>, <span class='va'>strength</span>, <span class='va'>dvote</span>, <span class='va'>rvote</span>, pow <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>

<span class='fu'>add_constr_incumbency</span><span class='op'>(</span><span class='va'>constr</span>, <span class='va'>strength</span>, <span class='va'>incumbents</span><span class='op'>)</span>

<span class='fu'>add_constr_splits</span><span class='op'>(</span><span class='va'>constr</span>, <span class='va'>strength</span><span class='op'>)</span>

<span class='fu'>add_constr_multisplits</span><span class='op'>(</span><span class='va'>constr</span>, <span class='va'>strength</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>strength</th>
      <td><p>The strength of the constraint. Higher values mean a more restrictive constraint.</p></td>
    </tr>
    <tr>
      <th>current</th>
      <td><p>The reference map for the status quo constraint.</p></td>
    </tr>
    <tr>
      <th>group_pop</th>
      <td><p>A vector of group population</p></td>
    </tr>
    <tr>
      <th>total_pop</th>
      <td><p>A vector of total population. Defaults to the population vector used for sampling.</p></td>
    </tr>
    <tr>
      <th>tgt_group, tgt_other</th>
      <td><p>Target group shares for the power-type constraint.</p></td>
    </tr>
    <tr>
      <th>pow</th>
      <td><p>The exponent for the power-type constraint.</p></td>
    </tr>
    <tr>
      <th>tgts_group</th>
      <td><p>A vector of target group shares for the hinge-type constraint.</p></td>
    </tr>
    <tr>
      <th>dvote, rvote</th>
      <td><p>A vector of Democratic or Republican vote counts</p></td>
    </tr>
    <tr>
      <th>incumbents</th>
      <td><p>A vector of precinct indicess for incumbents</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>All constraints are fed into a Gibbs measure, with coefficients on each
constraint set by the corresponding <code>strength</code> parameter.
The strength can be any real number, with zero corresponding to no constraint.
Higher and higher <code>strength</code> values will eventually cause the algorithm's
accuracy and efficiency to suffer. Whenever you use constraints, be sure to
check all sampling diagnostics.</p>
<p>The <code>status_quo</code> constraint adds a term measuring the variation of
information distance between the plan and the reference, rescaled to [0, 1].</p>
<p>The <code>grp_hinge</code> constraint takes a list of target group percentages. It
matches each district to its nearest target percentage, and then applies a
penalty of the form \(\sqrt{max(0, tgt - grouppct)}\), summing across
districts. This penalizes districts which are below their target percentage.</p>
<p>The <code>grp_pow</code> constraint (for expert use) adds a term of the form
\((|tgtgroup-grouppct||tgtother-grouppct|)^{pow})\), which
encourages districts to have group shares near either <code>tgt_group</code>
or <code>tgt_other</code>.</p>
<p>The <code>compet</code> constraint encourages competitiveness by applying the <code>grp_pow</code>
constraint with target percentages set to 50%. For convenience, it is
specified with Democratic and Republican vote shares.</p>
<p>The <code>incumbency</code> constraint adds a term counting the number of districts
containing paired-up incumbents.
Values of <code>strength</code> should generally be small, given that the underlying values are counts.</p>
<p>The <code>splits</code> constraint adds a term counting the number of
counties which are split once or more.
Values of <code>strength</code> should generally be small, given that the underlying values are counts.</p>
<p>The <code>multisplits</code> constraint adds a term counting the number of
counties which are split twice or more.
Values of <code>strength</code> should generally be small, given that the underlying values are counts.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Christopher T. Kenny, Cory McCartan, Ben Fifield, Kosuke Imai.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


