<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Diagnostic information on sampled plans — summary.redist_plans • redist</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Diagnostic information on sampled plans — summary.redist_plans"><meta property="og:description" content="Prints diagnostic information, which varies by algorithm. All algorithms
compute the plans_diversity() of the samples."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">redist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/redist.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/common_args.html">Common Arguments to `redist` Functions</a>
    </li>
    <li>
      <a href="../articles/map-preproc.html">Map Pre-processing for Special Constraints</a>
    </li>
    <li>
      <a href="../articles/mcmc.html">Redistricting with Flip MCMC</a>
    </li>
    <li>
      <a href="../articles/mpi-slurm.html">MPI / Slurm Sample Scripts</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Releases</li>
    <li>
      <a href="https://alarm-redist.github.io/posts/2021-04-02-redist-300/" class="external-link">redist 3.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alarm-redist/redist/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Diagnostic information on sampled plans</h1>
    <small class="dont-index">Source: <a href="https://github.com/alarm-redist/redist/blob/HEAD/R/diagnostics.R" class="external-link"><code>R/diagnostics.R</code></a></small>
    <div class="hidden name"><code>summary.redist_plans.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Prints diagnostic information, which varies by algorithm. All algorithms
compute the <code><a href="plans_diversity.html">plans_diversity()</a></code> of the samples.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S3 method for redist_plans</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, district <span class="op">=</span> <span class="fl">1L</span>, all_runs <span class="op">=</span> <span class="cn">TRUE</span>, vi_max <span class="op">=</span> <span class="fl">100</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>a <a href="redist_plans.html">redist_plans</a> object</p></dd>
<dt>district</dt>
<dd><p>For R-hat values, which district to use for district-level
summary statistics. We strongly recommend calling <code><a href="match_numbers.html">match_numbers()</a></code> or
<code><a href="number_by.html">number_by()</a></code> before examining these district-level statistics.</p></dd>
<dt>all_runs</dt>
<dd><p>When there are multiple SMC runs, show detailed summary
statistics for all runs (the default), or only the first run?</p></dd>
<dt>vi_max</dt>
<dd><p>The maximum number of plans to sample in computing the pairwise
variation of information distance (sample diversity).</p></dd>
<dt>...</dt>
<dd><p>additional arguments (ignored)</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame containing diagnostic information, invisibly.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>For SMC and MCMC, if there are multiple runs/chains, R-hat values will be
computed for each summary statistic. These values should be close to 1.
If they are not, then there is too much between-chain variation, indicating
that there are not enough samples. R-hat values are calculated after
rank-normalization and folding.  MCMC chains are split in half before R-hat
is computed. For summary statistics that vary across districts, R-hat is
calculated for the first district only.</p>
<p>For SMC, diagnostics statistics include:</p><ul><li><p><strong>Effective samples</strong>: the effective sample size at each iteration, computed
using the SMC weights. Larger is better. The percentage in parentheses is the
ratio of the effective samples to the total samples.</p></li>
<li><p><strong>Acceptance rate</strong>: the fractino of drawn spanning trees which yield a valid
redistricting plan within the population tolerance. Very small values (&lt; 1%)
can indicate a bottleneck and may lead to a lack of diversity.</p></li>
<li><p><strong>Standard deviation of the log weights</strong>: More variable weights (larger s.d.)
indicate less efficient sampling. Values greater than 3 are likely problematic.</p></li>
<li><p><strong>Maximum unique plans:</strong> an upper bound on the number of unique redistricting
plans that survive each stage. The percentage in parentheses is the ratio of
this number to expected number of unique plans under equal-probability
multinomial resampling. Small values (&lt; 100) indicate a bottleneck, which
leads to a loss of sample diversity and a higher variance.</p></li>
<li><p><strong>Estimated <code>k</code> parameter</strong>: How many spanning tree edges were considered for
cutting at each split. Mostly informational, though large jumps may indicate
a need to increase <code>adapt_k_thresh</code>.</p></li>
<li><p><strong>Bottleneck</strong>: An asterisk will appear in the right column if a bottleneck
appears likely, based on the values of the other statistics.</p></li>
</ul><p>In the event of problematic diagnostics, the function will provide
suggestions for improvement.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iowa</span><span class="op">)</span></span>
<span class="r-in"><span class="va">iowa_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="redist_map.html">redist_map</a></span><span class="op">(</span><span class="va">iowa</span>, ndists <span class="op">=</span> <span class="fl">4</span>, pop_tol <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">plans</span> <span class="op">&lt;-</span> <span class="fu"><a href="redist_smc.html">redist_smc</a></span><span class="op">(</span><span class="va">iowa_map</span>, <span class="fl">100</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEQUENTIAL MONTE CARLO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling 100 99-unit maps with 4 districts and population between 685,430 and 837,748.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Split [0/3] <span style="color: #00BB00;">■                               </span> | ETA?</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Split [3/3] <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> | ETA 0s</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">plans</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">SMC:</span> 100 sampled plans of 4 districts on 99 units</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `adapt_k_thresh`=0.985 • `seq_alpha`=0.5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `est_label_mult`=1 • `pop_temper`=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plan diversity 80% range: 0.50 to 0.84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sampling diagnostics for SMC run 1 of 1 (100 samples)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Eff. samples (%) Acc. rate Log wgt. sd  Max. unique Est. k </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Split 1        98 (97.6%)     28.3%        0.30    64 (101%)     11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Split 2        97 (96.9%)     28.6%        0.35    60 ( 95%)      9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Split 3        96 (96.3%)     12.5%        0.40    57 ( 90%)      7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Resample       85 (84.9%)       NA%        0.38    62 ( 98%)     NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="color: #555555;"> Watch out for low effective samples, very low acceptance rates (less than</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">1%), large std. devs. of the log weights (more than 3 or so), and low numbers</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">of unique plans. R-hat values for summary statistics should be between 1 and</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">1.05.</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christopher T. Kenny, Cory McCartan, Ben Fifield, Kosuke Imai.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

