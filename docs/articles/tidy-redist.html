<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tidy `redist` • redist</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tidy `redist`">
<meta property="og:description" content="redist">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">redist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/redist.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/map-preproc.html">Map Pre-processing for Special Constraints</a>
    </li>
    <li>
      <a href="../articles/mcmc.html">Redistricting with MCMC and RSG</a>
    </li>
    <li>
      <a href="../articles/mpi-slurm.html">MPI / Slurm Sample Scripts</a>
    </li>
    <li>
      <a href="../articles/tidy-redist.html">Tidy `redist`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kosukeimai/redist/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tidy-redist_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tidy <code>redist</code>
</h1>
            
            <h4 class="date">2021-03-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kosukeimai/redist/blob/master/vignettes/tidy-redist.Rmd"><code>vignettes/tidy-redist.Rmd</code></a></small>
      <div class="hidden name"><code>tidy-redist.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<p>We begin by loading <code>tidyverse</code> and the <code>redist</code> library, and reading in our shapefile.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">redist</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">east_tx</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">east_tx</span><span class="op">)</span></code></pre></div>
</div>
<div id="specifying-the-redistricting-problem" class="section level1">
<h1 class="hasAnchor">
<a href="#specifying-the-redistricting-problem" class="anchor"></a>Specifying the Redistricting Problem</h1>
<p>The first thing we do is to create a <code>redist_map</code> object, which is essentially a data frame along with an adjacency graph and a little extra metadata about the redistricting problem at hand. It’s important to create this object early on, since data operations like filtering and summarizing will affect the graph structure, number of district, and population constraints.</p>
<p>Here, the existing district assignment is stored in the <code>cd</code> column. We provide let <code><a href="../reference/redist_map.html">redist_map()</a></code> know about this by providing the <code>existing_col</code> argument, and we use <code><a href="https://rdrr.io/r/base/Extremes.html">max(cd)</a></code> to count the total number of districts.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">east_tx_map</span> <span class="op">=</span> <span class="fu"><a href="../reference/redist_map.html">redist_map</a></span><span class="op">(</span><span class="va">east_tx</span>, pop_tol<span class="op">=</span><span class="fl">0.05</span>, existing_plan<span class="op">=</span><span class="va">cd</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">east_tx_map</span><span class="op">)</span></code></pre></div>
<p>Our original shapefile stored its geographic information in terms of latitude and longitude. While common, this can cause problems for some of the geographic operations used in the analysis process, so by default <code><a href="../reference/redist_map.html">redist_map()</a></code> will reproject the shapefile geometry to a new coordinate system. Whether to do this and which coordinate system to use can be controlled using the <code>planarize</code> argument.</p>
<div id="subsetting" class="section level2">
<h2 class="hasAnchor">
<a href="#subsetting" class="anchor"></a>Subsetting</h2>
<p>Suppose that we want to focus our analysis on the Houston area, which for our purposes means the 2nd, 7th, 9th, 18th, 22nd, and 29th congressional districts. We can do this simply by using <code>dplyr</code>’s <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_area</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">east_tx_map</span>, <span class="va">cd</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">18</span>, <span class="fl">22</span>, <span class="fl">29</span><span class="op">)</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_area</span><span class="op">)</span></code></pre></div>
<p>Behind the scenes, <code>redist</code> has adjusted the adjacency graph to remove the precincts that were filtered away. It has also adjusted the number of districts and the population bounds.</p>
<p>We can easily plot this new map, either by congressional district or by any other quantity of interest.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">houston_area</span>, edges<span class="op">=</span><span class="cn">F</span>, centroids<span class="op">=</span><span class="cn">F</span><span class="op">)</span> <span class="co"># hide the hundreds of graph edges and vertices</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">houston_area</span>, fill<span class="op">=</span><span class="va">hisp</span><span class="op">/</span><span class="va">pop</span><span class="op">)</span></code></pre></div>
</div>
<div id="merging" class="section level2">
<h2 class="hasAnchor">
<a href="#merging" class="anchor"></a>Merging</h2>
<p>If we want to base our analysis on a geographical unit other than precincts, we use the <code><a href="../reference/merge_by.html">merge_by()</a></code> function, which calls <code>dplyr</code>’s <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> in the background. It also tries to intelligently summarize the other columns in the data frame—adding up the population in each county, for instance. By default, <code><a href="../reference/merge_by.html">merge_by()</a></code> will also group by the current congressional districts, if they are provided, to avoid erasing these lines.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_counties</span> <span class="op">=</span> <span class="va">houston_area</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/merge_by.html">merge_by</a></span><span class="op">(</span><span class="va">county</span>, drop_geom<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_counties</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">houston_counties</span>, fill<span class="op">=</span><span class="va">hisp</span><span class="op">/</span><span class="va">pop</span><span class="op">)</span></code></pre></div>
<p>We specify <code>drop_geom=FALSE</code> so that the shapefile geometries are also merged. Since this is a time-consuming process and is not necessary for redistricting analysis, by default <code><a href="../reference/merge_by.html">merge_by()</a></code> drops the shapefile geometry.</p>
<p>If more fine-grained control is needed than is provided by <code><a href="../reference/merge_by.html">merge_by()</a></code>, you can always use <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>, which will still make the appropriate modifications to the adjacency graph.</p>
<p>Another common use of <code><a href="../reference/merge_by.html">merge_by()</a></code> is for creating district “cores”: gluing precincts in the “core” of an area together, to ensure that they stay together throughout redistricting. This has the effect of imposing a status quo constraint when applied to existing districts. Here, any precincts that are not within 1 precinct of the district borders will be merged into the district cores.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_cores</span> <span class="op">=</span> <span class="va">houston_area</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cd_cores <span class="op">=</span> <span class="fu"><a href="../reference/redist.identify.cores.html">make_cores</a></span><span class="op">(</span>within<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="../reference/merge_by.html">merge_by</a></span><span class="op">(</span><span class="va">cd_cores</span>, drop_geom<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_cores</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">houston_cores</span>, centroids<span class="op">=</span><span class="cn">F</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="simulating-and-analyzing-plans" class="section level1">
<h1 class="hasAnchor">
<a href="#simulating-and-analyzing-plans" class="anchor"></a>Simulating and Analyzing Plans</h1>
<p>After preprocessing the map to focus on the redistricting problem of interest, we are ready to run the redistricting simulation. The recommended simulation function is <code><a href="../reference/redist_smc.html">redist_smc()</a></code>, which uses a Sequential Monte Carlo (SMC) algorithm.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_plans</span> <span class="op">=</span> <span class="fu"><a href="../reference/redist_smc.html">redist_smc</a></span><span class="op">(</span><span class="va">houston_cores</span>, <span class="fl">100</span>, counties<span class="op">=</span><span class="va">county</span>, verbose<span class="op">=</span><span class="cn">F</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/add_reference.html">add_reference</a></span><span class="op">(</span><span class="va">houston_cores</span><span class="op">$</span><span class="va">cd</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_plans</span><span class="op">)</span></code></pre></div>
<p>Since district numbers in simulated plans are by and large random, we often want to renumber the simulated districts to match the district numbers in the original plan, something which is easily accomplished by the function <code><a href="../reference/match_numbers.html">match_numbers()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_plans</span> <span class="op">=</span> <span class="fu"><a href="../reference/match_numbers.html">match_numbers</a></span><span class="op">(</span><span class="va">houston_plans</span>, <span class="va">houston_cores</span><span class="op">$</span><span class="va">cd</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_plans</span><span class="op">)</span></code></pre></div>
<p>This function also creates a new column, which records, for each plan, the fraction of the total population which lives in the same district under the reference plan.</p>
<p>We can then easily add summary statistics for each district. The <code><a href="../reference/redist.compactness.html">distr_compactness()</a></code> and <code><a href="../reference/redist.group.percent.html">group_frac()</a></code> functions will implicitly reference the simulated plans matrix when called inside <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_plans</span> <span class="op">=</span> <span class="va">houston_plans</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>comp <span class="op">=</span> <span class="fu"><a href="../reference/redist.compactness.html">distr_compactness</a></span><span class="op">(</span><span class="va">houston_cores</span><span class="op">)</span>,
           pct_hisp <span class="op">=</span> <span class="fu"><a href="../reference/redist.group.percent.html">group_frac</a></span><span class="op">(</span><span class="va">houston_cores</span>, <span class="va">hvap</span>, <span class="va">vap</span><span class="op">)</span>,
           pct_black <span class="op">=</span> <span class="fu"><a href="../reference/redist.group.percent.html">group_frac</a></span><span class="op">(</span><span class="va">houston_cores</span>, <span class="va">bvap</span>, <span class="va">vap</span><span class="op">)</span>,
           pct_white <span class="op">=</span> <span class="fu"><a href="../reference/redist.group.percent.html">group_frac</a></span><span class="op">(</span><span class="va">houston_cores</span>, <span class="va">wvap</span>, <span class="va">vap</span><span class="op">)</span>,
           pct_min <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">pct_white</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_plans</span><span class="op">)</span></code></pre></div>
<p>If we wanted, we could sort and number districts according to one of these statistics using the <code><a href="../reference/number_by.html">number_by()</a></code> function.</p>
<p>From there, it’s easy to summarize summary statistics by plan.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">min_distr</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">houston_plans</span>, <span class="va">draw</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>n_black <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pct_black</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span>,
              n_hisp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pct_hisp</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span>,
              n_coalition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pct_min</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">min_distr</span><span class="op">)</span></code></pre></div>
<p>And <code>redist</code> provides several useful plotting functions. By default, <code>plot</code> calls <code>hist</code>, which makes a histogram of a quantity of interest along with a reference line for each reference plan.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ggplots with nice defaults and labels</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">min_distr</span>, <span class="va">n_coalition</span><span class="op">)</span>
<span class="fu"><a href="../reference/redist.plot.distr_qtys.html">redist.plot.distr_qtys</a></span><span class="op">(</span><span class="va">houston_plans</span>, <span class="va">pct_hisp</span><span class="op">)</span>
<span class="co"># don't sort; use existing district numbers</span>
<span class="fu"><a href="../reference/redist.plot.distr_qtys.html">redist.plot.distr_qtys</a></span><span class="op">(</span><span class="va">houston_plans</span>, <span class="va">pct_hisp</span>, sort<span class="op">=</span><span class="cn">F</span><span class="op">)</span></code></pre></div>
<p>We can also re-index the plans back to the original, un-merged map.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_orig_plans</span> <span class="op">=</span> <span class="fu"><a href="../reference/pullback.html">pullback</a></span><span class="op">(</span><span class="va">houston_plans</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_orig_plans</span><span class="op">)</span>
<span class="fu">redist.plot.plan</span><span class="op">(</span><span class="va">houston_orig_plans</span>, draw<span class="op">=</span><span class="fl">5</span>, geom<span class="op">=</span><span class="va">houston_area</span><span class="op">)</span></code></pre></div>
</div>
<div id="all-together" class="section level1">
<h1 class="hasAnchor">
<a href="#all-together" class="anchor"></a>All Together</h1>
<p>A minimum working example for the ‘signature of gerrymandering’.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston</span> <span class="op">=</span> <span class="va">east_tx</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/redist_map.html">redist_map</a></span><span class="op">(</span>pop_tol<span class="op">=</span><span class="fl">0.05</span>, existing_plan<span class="op">=</span><span class="va">cd</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cd</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">18</span>, <span class="fl">22</span>, <span class="fl">29</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># filter to Houston area</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cd_cores <span class="op">=</span> <span class="fu"><a href="../reference/redist.identify.cores.html">make_cores</a></span><span class="op">(</span>within<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/merge_by.html">merge_by</a></span><span class="op">(</span><span class="va">cd_cores</span><span class="op">)</span>

<span class="va">houston_plans</span> <span class="op">=</span> <span class="fu"><a href="../reference/redist_smc.html">redist_smc</a></span><span class="op">(</span><span class="va">houston</span>, <span class="fl">100</span>, counties<span class="op">=</span><span class="va">county</span>, silent<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span>    
    <span class="fu"><a href="../reference/add_reference.html">add_reference</a></span><span class="op">(</span><span class="va">houston</span><span class="op">$</span><span class="va">cd</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/match_numbers.html">match_numbers</a></span><span class="op">(</span><span class="va">houston</span><span class="op">$</span><span class="va">cd</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pct_hisp <span class="op">=</span> <span class="fu"><a href="../reference/redist.group.percent.html">group_frac</a></span><span class="op">(</span><span class="va">houston</span>, <span class="va">hvap</span>, <span class="va">vap</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/redist.plot.distr_qtys.html">redist.plot.distr_qtys</a></span><span class="op">(</span><span class="va">houston_plans</span>, <span class="va">pct_hisp</span><span class="op">)</span></code></pre></div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>McCartan, C., &amp; Imai, K. (2020). Sequential Monte Carlo for Sampling Balanced and Compact Redistricting Plans. Available at <a href="https://imai.fas.harvard.edu/research/files/SMCredist.pdf" class="uri">https://imai.fas.harvard.edu/research/files/SMCredist.pdf</a>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ben Fifield, Christopher T. Kenny, Cory McCartan, Jun Kawahara, Kosuke Imai.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
