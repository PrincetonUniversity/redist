<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tidy `redist` • redist</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tidy `redist`">
<meta property="og:description" content="redist">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">redist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tidy-redist.html">Tidy `redist`</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kosukeimai/redist/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tidy-redist_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tidy <code>redist</code>
</h1>
            
            <h4 class="date">2021-02-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kosukeimai/redist/blob/master/vignettes/tidy-redist.Rmd"><code>vignettes/tidy-redist.Rmd</code></a></small>
      <div class="hidden name"><code>tidy-redist.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<p>We begin by loading <code>tidyverse</code> and the <code>redist</code> library, and reading in our shapefile.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">redist</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">east_tx</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">texas_shp</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 3138 features and 13 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: -414696.7 ymin: 310898.7 xmax: 237123.4 ymax: 993178.7</span>
<span class="co">#&gt; projected CRS:  NAD83 / Conus Albers</span>
<span class="co">#&gt; # A tibble: 3,138 x 14</span>
<span class="co">#&gt;    county id                     geometry    cd   pop black  hisp white   vap</span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;        &lt;MULTIPOLYGON [m]&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 029    4802… (((-225344.9 724204.5, -…    28   355    29   127   178   291</span>
<span class="co">#&gt;  2 029    4802… (((-221901.9 718229.7, -…    28   153    31    87    20    29</span>
<span class="co">#&gt;  3 029    4802… (((-221901.2 716816.7, -…    28   958   164   297   440   643</span>
<span class="co">#&gt;  4 029    4802… (((-225942 703767.3, -22…    28  3895   174  1126  2528  2931</span>
<span class="co">#&gt;  5 029    4802… (((-224111.1 703124.3, -…    28  1588    40   371  1165  1227</span>
<span class="co">#&gt;  6 029    4802… (((-229268.4 701654.1, -…    28   328     3    93   230   276</span>
<span class="co">#&gt;  7 029    4802… (((-226356.7 715765.3, -…    28  7499  2274  3220  1581  4829</span>
<span class="co">#&gt;  8 029    4802… (((-224091.7 715995.9, -…    28    10     1     3     6     8</span>
<span class="co">#&gt;  9 029    4802… (((-231919.2 706761.5, -…    28  1087   251   655   157   787</span>
<span class="co">#&gt; 10 029    4802… (((-217227.7 710079.4, -…    28    54     7     8    39    45</span>
<span class="co">#&gt; # … with 3,128 more rows, and 5 more variables: bvap &lt;dbl&gt;, hvap &lt;dbl&gt;,</span>
<span class="co">#&gt; #   wvap &lt;dbl&gt;, dem &lt;int&gt;, gop &lt;int&gt;</span></code></pre></div>
</div>
<div id="specifying-the-redistricting-problem" class="section level1">
<h1 class="hasAnchor">
<a href="#specifying-the-redistricting-problem" class="anchor"></a>Specifying the Redistricting Problem</h1>
<p>The first thing we do is to create a <code>redist_map</code> object, which is essentially a data frame along with an adjacency graph and a little extra metadata about the redistricting problem at hand. It’s important to create this object early on, since data operations like filtering and summarizing will affect the graph structure, number of district, and population constraints.</p>
<p>Here, the existing district assignment is stored in the <code>cd</code> column. We provide let <code>redist_map</code> know about this by providing the <code>existin_col</code> argument, and we use <code><a href="https://rdrr.io/r/base/Extremes.html">max(cd)</a></code> to count the total number of districts.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tx</span> <span class="op">=</span> <span class="fu"><a href="../reference/redist_map.html">redist_map</a></span><span class="op">(</span><span class="va">texas_shp</span>, pop_tol<span class="op">=</span><span class="fl">0.05</span>, existing_col<span class="op">=</span><span class="va">cd</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tx</span><span class="op">)</span>
<span class="co">#&gt; A redist_map object with 3138 units and 15 fields</span>
<span class="co">#&gt; To be partitioned into 15 districts with population between 698,224.4 - 5.0% and 698,224.4 + 5.0%</span>
<span class="co">#&gt; With geometry:</span>
<span class="co">#&gt;     bbox:           xmin: -414696.7 ymin: 310898.7 xmax: 237123.4 ymax: 993178.7</span>
<span class="co">#&gt;     projected CRS:  NAD83 / Conus Albers</span>
<span class="co">#&gt; # A tibble: 3,138 x 15</span>
<span class="co">#&gt;    county id                     geometry    cd   pop black  hisp white   vap</span>
<span class="co">#&gt;  * &lt;chr&gt;  &lt;chr&gt;        &lt;MULTIPOLYGON [m]&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 029    4802… (((-225344.9 724204.5, -…    28   355    29   127   178   291</span>
<span class="co">#&gt;  2 029    4802… (((-221901.9 718229.7, -…    28   153    31    87    20    29</span>
<span class="co">#&gt;  3 029    4802… (((-221901.2 716816.7, -…    28   958   164   297   440   643</span>
<span class="co">#&gt;  4 029    4802… (((-225942 703767.3, -22…    28  3895   174  1126  2528  2931</span>
<span class="co">#&gt;  5 029    4802… (((-224111.1 703124.3, -…    28  1588    40   371  1165  1227</span>
<span class="co">#&gt;  6 029    4802… (((-229268.4 701654.1, -…    28   328     3    93   230   276</span>
<span class="co">#&gt;  7 029    4802… (((-226356.7 715765.3, -…    28  7499  2274  3220  1581  4829</span>
<span class="co">#&gt;  8 029    4802… (((-224091.7 715995.9, -…    28    10     1     3     6     8</span>
<span class="co">#&gt;  9 029    4802… (((-231919.2 706761.5, -…    28  1087   251   655   157   787</span>
<span class="co">#&gt; 10 029    4802… (((-217227.7 710079.4, -…    28    54     7     8    39    45</span>
<span class="co">#&gt; # … with 3,128 more rows, and 6 more variables: bvap &lt;dbl&gt;, hvap &lt;dbl&gt;,</span>
<span class="co">#&gt; #   wvap &lt;dbl&gt;, dem &lt;int&gt;, gop &lt;int&gt;, graph &lt;list&gt;</span></code></pre></div>
<p>Our original shapefile stored its geographic information in terms of latitude and longitude. While common, this can cause problems for some of the geographic operations used in the analysis process, so by default <code>redist_map</code> will reproject the shapefile geometry to a new coordinate system. Whether to do this and which coordinate system to use can be controlled using the <code>planarize</code> argument.</p>
<div id="subsetting" class="section level2">
<h2 class="hasAnchor">
<a href="#subsetting" class="anchor"></a>Subsetting</h2>
<p>Suppose that we want to focus our analysis on the Houston area, which for our purposes means the 2nd, 7th, 9th, 18th, 22nd, and 29th congressional districts. We can do this simply by using <code>dplyr</code>’s <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_area</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">tx</span>, <span class="va">cd</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">18</span>, <span class="fl">22</span>, <span class="fl">29</span><span class="op">)</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_area</span><span class="op">)</span>
<span class="co">#&gt; A redist_map object with 937 units and 15 fields</span>
<span class="co">#&gt; To be partitioned into 6 districts with population between 698,224.4 - 5.0% and 698,224.4 + 5.0%</span>
<span class="co">#&gt; With geometry:</span>
<span class="co">#&gt;     bbox:           xmin: -8610.921 ymin: 687624.4 xmax: 94290.38 ymax: 788347.1</span>
<span class="co">#&gt;     projected CRS:  NAD83 / Conus Albers</span>
<span class="co">#&gt; # A tibble: 937 x 15</span>
<span class="co">#&gt;    county id                     geometry    cd   pop black  hisp white   vap</span>
<span class="co">#&gt;  * &lt;chr&gt;  &lt;chr&gt;        &lt;MULTIPOLYGON [m]&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 039    4803… (((56463.9 723325.4, 573…    22  9997  2808  1031  2925  6940</span>
<span class="co">#&gt;  2 039    4803… (((73701.52 703342.2, 74…    22  3653   190  1061  2257  2718</span>
<span class="co">#&gt;  3 039    4803… (((69637.14 720067.7, 70…    22  7263   591  1516  4691  4927</span>
<span class="co">#&gt;  4 039    4803… (((62778.08 723607.8, 63…    22  5196   488  2015  2381  3828</span>
<span class="co">#&gt;  5 039    4803… (((63199.55 720686.6, 66…    22  7303  1969  1761  2976  4991</span>
<span class="co">#&gt;  6 039    4803… (((68047.92 724871.3, 69…    22  3791   188  1466  2006  2770</span>
<span class="co">#&gt;  7 039    4803… (((67244.84 719969, 6722…    22  4816   541  1594  2454  3308</span>
<span class="co">#&gt;  8 039    4803… (((59370.14 715476.7, 59…    22  5541   220  1501  3668  4165</span>
<span class="co">#&gt;  9 039    4803… (((55768.81 696116.4, 55…    22  3947   282  1073  1979  2883</span>
<span class="co">#&gt; 10 039    4803… (((68627.5 711720.8, 692…    22  6124   118  2131  3773  4463</span>
<span class="co">#&gt; # … with 927 more rows, and 6 more variables: bvap &lt;dbl&gt;, hvap &lt;dbl&gt;,</span>
<span class="co">#&gt; #   wvap &lt;dbl&gt;, dem &lt;int&gt;, gop &lt;int&gt;, graph &lt;list&gt;</span></code></pre></div>
<p>Behind the scenes, <code>redist</code> has adjusted the adjacency graph to remove the precincts that were filtered away. It has also adjusted the number of districts and the population bounds.</p>
<p>We can easily plot this new map, either by congressional district or by any other quantity of interest.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">houston_area</span>, edges<span class="op">=</span><span class="cn">F</span>, centroids<span class="op">=</span><span class="cn">F</span><span class="op">)</span> <span class="co"># hide the hundreds of graph edges and vertices</span></code></pre></div>
<p><img src="tidy-redist_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">houston_area</span>, <span class="va">hisp</span><span class="op">/</span><span class="va">pop</span><span class="op">)</span></code></pre></div>
<p><img src="tidy-redist_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
</div>
<div id="merging" class="section level2">
<h2 class="hasAnchor">
<a href="#merging" class="anchor"></a>Merging</h2>
<p>If we want to base our analysis on a geographical unit other than precincts, we use the <code><a href="../reference/merge_by.html">merge_by()</a></code> function, which calls <code>dplyr</code>’s <code>group_by()</code> and <code>summarize()</code> in the background. It also tries to intelligently summarize the other columns in the data frame—adding up the population in each county, for instance. By default, <code><a href="../reference/merge_by.html">merge_by()</a></code> will also group by the current congressional districts, if they are provided, to avoid erasing these lines.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_counties</span> <span class="op">=</span> <span class="va">houston_area</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/merge_by.html">merge_by</a></span><span class="op">(</span><span class="va">county</span>, drop_geom<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_counties</span><span class="op">)</span>
<span class="co">#&gt; A redist_map object with 9 units and 15 fields</span>
<span class="co">#&gt; To be partitioned into 6 districts with population between 698,224.4 - 5.0% and 698,224.4 + 5.0%</span>
<span class="co">#&gt; Merged from another map with reindexing: int [1:937] 1 1 1 1 1 ...</span>
<span class="co">#&gt; With geometry:</span>
<span class="co">#&gt;     bbox:           xmin: -8610.921 ymin: 687624.4 xmax: 94290.38 ymax: 788347.1</span>
<span class="co">#&gt;     projected CRS:  NAD83 / Conus Albers</span>
<span class="co">#&gt; # A tibble: 9 x 15</span>
<span class="co">#&gt; # Groups:   county [3]</span>
<span class="co">#&gt;   county    cd    pop  black   hisp  white    vap   bvap   hvap   wvap    dem</span>
<span class="co">#&gt; * &lt;chr&gt;  &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;int&gt;</span>
<span class="co">#&gt; 1 039       22 156654  19318  40012  79274 110649  13319  25286  60040  24205</span>
<span class="co">#&gt; 2 157        9 145730  69603  39719  19598 102332  48129  25602  16358  34129</span>
<span class="co">#&gt; 3 157       22 439645  53664  99248 192082 309208  36848  63714 142711  73263</span>
<span class="co">#&gt; 4 201        2 705967  67459 217675 357581 523630  47485 142955 286983 114587</span>
<span class="co">#&gt; 5 201        7 699765  77708 211140 331256 520299  55540 141088 265013 124112</span>
<span class="co">#&gt; 6 201        9 552240 199127 221020  60303 398114 143132 144769  53043 102918</span>
<span class="co">#&gt; 7 201       18 690022 276331 266736 114318 499911 202616 172154 100367 146444</span>
<span class="co">#&gt; 8 201       22 105397  13045  33105  45417  77620   9176  21728  36830  14781</span>
<span class="co">#&gt; 9 201       29 695465  66741 531650  81193 469405  46629 341966  69148  92027</span>
<span class="co">#&gt; # … with 4 more variables: gop &lt;int&gt;, id &lt;chr&gt;, geometry &lt;GEOMETRY [m]&gt;,</span>
<span class="co">#&gt; #   graph &lt;list&gt;</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">houston_counties</span>, <span class="va">hisp</span><span class="op">/</span><span class="va">pop</span><span class="op">)</span></code></pre></div>
<p><img src="tidy-redist_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>We specify <code>drop_geom=FALSE</code> so that the shapefile geometries are also merged. Since this is a time-consuming process and is not necessary for redistricting analysis, by default <code><a href="../reference/merge_by.html">merge_by()</a></code> drops the shapefile geometry.</p>
<p>If more fine-grained control is needed than is provided by <code><a href="../reference/merge_by.html">merge_by()</a></code>, you can always use <code>group_by()</code> and <code>summarize()</code>, which will still make the appropriate modifications to the adjacency graph.</p>
<p>Another common use of <code><a href="../reference/merge_by.html">merge_by()</a></code> is for creating district “cores”: gluing precincts in the “core” of an area together, to ensure that they stay together throughout redistricting. This has the effect of imposing a status quo constraint when applied to existing districts. Here, any precincts that are not within 1 precinct of the district borders will be merged into the district cores.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_cores</span> <span class="op">=</span> <span class="va">houston_area</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>cd_cores <span class="op">=</span> <span class="fu"><a href="../reference/redist.identify.cores.html">make_cores</a></span><span class="op">(</span>within<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="../reference/merge_by.html">merge_by</a></span><span class="op">(</span><span class="va">cd_cores</span>, drop_geom<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_cores</span><span class="op">)</span>
<span class="co">#&gt; A redist_map object with 475 units and 16 fields</span>
<span class="co">#&gt; To be partitioned into 6 districts with population between 698,224.4 - 5.0% and 698,224.4 + 5.0%</span>
<span class="co">#&gt; Merged from another map with reindexing: int [1:937] 220 218 218 231 218 ...</span>
<span class="co">#&gt; With geometry:</span>
<span class="co">#&gt;     bbox:           xmin: -8610.921 ymin: 687624.4 xmax: 94290.38 ymax: 788347.1</span>
<span class="co">#&gt;     projected CRS:  NAD83 / Conus Albers</span>
<span class="co">#&gt; # A tibble: 475 x 16</span>
<span class="co">#&gt; # Groups:   cd_cores [475]</span>
<span class="co">#&gt;    cd_cores    cd   pop black  hisp white   vap  bvap  hvap  wvap   dem   gop</span>
<span class="co">#&gt;  *    &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt;  1        1    18 85593 38236 35699  6314 57288 25678 22431  5378 13219  2267</span>
<span class="co">#&gt;  2        2    18     0     0     0     0     0     0     0     0  1424  1889</span>
<span class="co">#&gt;  3        3    18     0     0     0     0     0     0     0     0     0     0</span>
<span class="co">#&gt;  4        4    18     0     0     0     0     0     0     0     0   469   714</span>
<span class="co">#&gt;  5        5    18 59703 41291 16490  1228 43197 31365 10251  1088 17993   769</span>
<span class="co">#&gt;  6        6    18  3909  2981   841    45  2854  2260   517    41  1157    36</span>
<span class="co">#&gt;  7        7    18  3013  1967   986    34  2159  1525   590    26   861    29</span>
<span class="co">#&gt;  8        8    18 19291 13933  2100  2152 16071 11475  1493  2056  5726   394</span>
<span class="co">#&gt;  9        9    18 91896 35243 37809 15189 64662 25157 23687 13048 19540  7037</span>
<span class="co">#&gt; 10       10    18   568   169   125   257   559   166   122   255    81    36</span>
<span class="co">#&gt; # … with 465 more rows, and 4 more variables: county &lt;chr&gt;, id &lt;chr&gt;,</span>
<span class="co">#&gt; #   geometry &lt;GEOMETRY [m]&gt;, graph &lt;list&gt;</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">houston_cores</span>, centroids<span class="op">=</span><span class="cn">F</span><span class="op">)</span></code></pre></div>
<p><img src="tidy-redist_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
</div>
<div id="simulating-and-analyzing-plans" class="section level1">
<h1 class="hasAnchor">
<a href="#simulating-and-analyzing-plans" class="anchor"></a>Simulating and Analyzing Plans</h1>
<p>After preprocessing the map to focus on the redistricting problem of interest, we are ready to run the redistricting simulation. The recommended simulation function is <code>redist_smc</code>, which uses a Sequential Monte Carlo (SMC) algorithm.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_plans</span> <span class="op">=</span> <span class="fu"><a href="../reference/redist_smc.html">redist_smc</a></span><span class="op">(</span><span class="va">houston_cores</span>, <span class="fl">100</span>, counties<span class="op">=</span><span class="va">county</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/add_reference.html">add_reference</a></span><span class="op">(</span><span class="va">houston_cores</span><span class="op">$</span><span class="va">cd</span><span class="op">)</span>
<span class="co">#&gt; Sampling 100 475-unit maps with 6 districts and population between 663313 and 733136.</span>
<span class="co">#&gt; Ensuring no more than 5 splits of the 6 administrative units.</span>
<span class="co">#&gt; Making split 1 of 5</span>
<span class="co">#&gt; Using k = 8</span>
<span class="co">#&gt; Iteration     10 / 100</span>
<span class="co">#&gt; Iteration     20 / 100</span>
<span class="co">#&gt; Iteration     30 / 100</span>
<span class="co">#&gt; Iteration     40 / 100</span>
<span class="co">#&gt; Iteration     50 / 100</span>
<span class="co">#&gt; Iteration     60 / 100</span>
<span class="co">#&gt; Iteration     70 / 100</span>
<span class="co">#&gt; Iteration     80 / 100</span>
<span class="co">#&gt; Iteration     90 / 100</span>
<span class="co">#&gt; Iteration    100 / 100</span>
<span class="co">#&gt; 32.2% acceptance rate.</span>
<span class="co">#&gt; Resampling effective sample size: 98.5 (98.5% efficiency).</span>
<span class="co">#&gt; Making split 2 of 5</span>
<span class="co">#&gt; Using k = 8</span>
<span class="co">#&gt; Iteration     10 / 100</span>
<span class="co">#&gt; Iteration     20 / 100</span>
<span class="co">#&gt; Iteration     30 / 100</span>
<span class="co">#&gt; Iteration     40 / 100</span>
<span class="co">#&gt; Iteration     50 / 100</span>
<span class="co">#&gt; Iteration     60 / 100</span>
<span class="co">#&gt; Iteration     70 / 100</span>
<span class="co">#&gt; Iteration     80 / 100</span>
<span class="co">#&gt; Iteration     90 / 100</span>
<span class="co">#&gt; Iteration    100 / 100</span>
<span class="co">#&gt; 30.2% acceptance rate.</span>
<span class="co">#&gt; Resampling effective sample size: 98.3 (98.3% efficiency).</span>
<span class="co">#&gt; Making split 3 of 5</span>
<span class="co">#&gt; Using k = 7</span>
<span class="co">#&gt; Iteration     10 / 100</span>
<span class="co">#&gt; Iteration     20 / 100</span>
<span class="co">#&gt; Iteration     30 / 100</span>
<span class="co">#&gt; Iteration     40 / 100</span>
<span class="co">#&gt; Iteration     50 / 100</span>
<span class="co">#&gt; Iteration     60 / 100</span>
<span class="co">#&gt; Iteration     70 / 100</span>
<span class="co">#&gt; Iteration     80 / 100</span>
<span class="co">#&gt; Iteration     90 / 100</span>
<span class="co">#&gt; Iteration    100 / 100</span>
<span class="co">#&gt; 30.1% acceptance rate.</span>
<span class="co">#&gt; Resampling effective sample size: 94.6 (94.6% efficiency).</span>
<span class="co">#&gt; Making split 4 of 5</span>
<span class="co">#&gt; Using k = 7</span>
<span class="co">#&gt; Iteration     10 / 100</span>
<span class="co">#&gt; Iteration     20 / 100</span>
<span class="co">#&gt; Iteration     30 / 100</span>
<span class="co">#&gt; Iteration     40 / 100</span>
<span class="co">#&gt; Iteration     50 / 100</span>
<span class="co">#&gt; Iteration     60 / 100</span>
<span class="co">#&gt; Iteration     70 / 100</span>
<span class="co">#&gt; Iteration     80 / 100</span>
<span class="co">#&gt; Iteration     90 / 100</span>
<span class="co">#&gt; Iteration    100 / 100</span>
<span class="co">#&gt; 21.7% acceptance rate.</span>
<span class="co">#&gt; Resampling effective sample size: 93.8 (93.8% efficiency).</span>
<span class="co">#&gt; Making split 5 of 5</span>
<span class="co">#&gt; Using k = 2</span>
<span class="co">#&gt; Iteration     10 / 100</span>
<span class="co">#&gt; Iteration     20 / 100</span>
<span class="co">#&gt; Iteration     30 / 100</span>
<span class="co">#&gt; Iteration     40 / 100</span>
<span class="co">#&gt; Iteration     50 / 100</span>
<span class="co">#&gt; Iteration     60 / 100</span>
<span class="co">#&gt; Iteration     70 / 100</span>
<span class="co">#&gt; Iteration     80 / 100</span>
<span class="co">#&gt; Iteration     90 / 100</span>
<span class="co">#&gt; Iteration    100 / 100</span>
<span class="co">#&gt; 5.1% acceptance rate.</span>
<span class="co">#&gt; Resampling effective sample size: 98.2 (98.2% efficiency).</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_plans</span><span class="op">)</span>
<span class="co">#&gt; 100 sampled plans and 1 reference plan with 6 districts from a 475-unit map,</span>
<span class="co">#&gt;   drawn using Sequential Monte Carlo</span>
<span class="co">#&gt; Merged from another map with reindexing: int [1:937] 220 218 218 231 218 ...</span>
<span class="co">#&gt; With plans resampled from weights</span>
<span class="co">#&gt; Plans matrix: num [1:475, 1:101] 4 4 4 4 4 4 4 4 4 4 ...</span>
<span class="co">#&gt; # A tibble: 606 x 3</span>
<span class="co">#&gt;    draw  district    pop</span>
<span class="co">#&gt;    &lt;fct&gt;    &lt;int&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1 &lt;ref&gt;        1 705967</span>
<span class="co">#&gt;  2 &lt;ref&gt;        2 699765</span>
<span class="co">#&gt;  3 &lt;ref&gt;        3 697970</span>
<span class="co">#&gt;  4 &lt;ref&gt;        4 690022</span>
<span class="co">#&gt;  5 &lt;ref&gt;        5 701696</span>
<span class="co">#&gt;  6 &lt;ref&gt;        6 695465</span>
<span class="co">#&gt;  7 1            1 683533</span>
<span class="co">#&gt;  8 1            2 714720</span>
<span class="co">#&gt;  9 1            3 721902</span>
<span class="co">#&gt; 10 1            4 667996</span>
<span class="co">#&gt; # … with 596 more rows</span></code></pre></div>
<p>We can then easily add summary statistics for each district. The <code>distr_compactness</code> and <code>group_frac</code> functions will implicitly reference the simulated plans matrix when called inside <code>mutate()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_plans</span> <span class="op">=</span> <span class="va">houston_plans</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>comp <span class="op">=</span> <span class="fu"><a href="../reference/redist.compactness.html">distr_compactness</a></span><span class="op">(</span><span class="va">houston_cores</span><span class="op">)</span>,
           pct_hisp <span class="op">=</span> <span class="fu"><a href="../reference/redist.group.percent.html">group_frac</a></span><span class="op">(</span><span class="va">houston_cores</span>, <span class="va">hvap</span>, <span class="va">vap</span><span class="op">)</span>,
           pct_black <span class="op">=</span> <span class="fu"><a href="../reference/redist.group.percent.html">group_frac</a></span><span class="op">(</span><span class="va">houston_cores</span>, <span class="va">bvap</span>, <span class="va">vap</span><span class="op">)</span>,
           pct_white <span class="op">=</span> <span class="fu"><a href="../reference/redist.group.percent.html">group_frac</a></span><span class="op">(</span><span class="va">houston_cores</span>, <span class="va">wvap</span>, <span class="va">vap</span><span class="op">)</span>,
           pct_min <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">pct_white</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_plans</span><span class="op">)</span>
<span class="co">#&gt; 100 sampled plans and 1 reference plan with 6 districts from a 475-unit map,</span>
<span class="co">#&gt;   drawn using Sequential Monte Carlo</span>
<span class="co">#&gt; Merged from another map with reindexing: int [1:937] 220 218 218 231 218 ...</span>
<span class="co">#&gt; With plans resampled from weights</span>
<span class="co">#&gt; Plans matrix: num [1:475, 1:101] 4 4 4 4 4 4 4 4 4 4 ...</span>
<span class="co">#&gt; # A tibble: 606 x 8</span>
<span class="co">#&gt;    draw  district    pop  comp pct_hisp pct_black pct_white pct_min</span>
<span class="co">#&gt;    &lt;fct&gt;    &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 &lt;ref&gt;        1 705967   874    0.273    0.0907     0.548   0.452</span>
<span class="co">#&gt;  2 &lt;ref&gt;        2 699765   874    0.271    0.107      0.509   0.491</span>
<span class="co">#&gt;  3 &lt;ref&gt;        3 697970   874    0.340    0.382      0.139   0.861</span>
<span class="co">#&gt;  4 &lt;ref&gt;        4 690022   874    0.344    0.405      0.201   0.799</span>
<span class="co">#&gt;  5 &lt;ref&gt;        5 701696   874    0.223    0.119      0.482   0.518</span>
<span class="co">#&gt;  6 &lt;ref&gt;        6 695465   874    0.729    0.0993     0.147   0.853</span>
<span class="co">#&gt;  7 1            1 683533   378    0.205    0.165      0.439   0.561</span>
<span class="co">#&gt;  8 1            2 714720   378    0.462    0.186      0.281   0.719</span>
<span class="co">#&gt;  9 1            3 721902   378    0.323    0.125      0.443   0.557</span>
<span class="co">#&gt; 10 1            4 667996   378    0.411    0.214      0.328   0.672</span>
<span class="co">#&gt; # … with 596 more rows</span></code></pre></div>
<p>From there, it’s easy to summary statistics by plan.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">min_distr</span> <span class="op">=</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">houston_plans</span>, <span class="va">draw</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>n_black <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pct_black</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span>,
              n_hisp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pct_hisp</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span>,
              n_coalition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pct_min</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">min_distr</span><span class="op">)</span>
<span class="co">#&gt; 100 sampled plans and 1 reference plan with 6 districts from a 475-unit map,</span>
<span class="co">#&gt;   drawn using Sequential Monte Carlo</span>
<span class="co">#&gt; Merged from another map with reindexing: int [1:937] 220 218 218 231 218 ...</span>
<span class="co">#&gt; With plans resampled from weights</span>
<span class="co">#&gt; Plans matrix: num [1:475, 1:101] 4 4 4 4 4 4 4 4 4 4 ...</span>
<span class="co">#&gt; # A tibble: 101 x 4</span>
<span class="co">#&gt;    draw  n_black n_hisp n_coalition</span>
<span class="co">#&gt;  * &lt;fct&gt;   &lt;int&gt;  &lt;int&gt;       &lt;int&gt;</span>
<span class="co">#&gt;  1 &lt;ref&gt;       0      1           4</span>
<span class="co">#&gt;  2 1           0      0           6</span>
<span class="co">#&gt;  3 2           0      1           6</span>
<span class="co">#&gt;  4 3           0      1           6</span>
<span class="co">#&gt;  5 4           0      1           6</span>
<span class="co">#&gt;  6 5           0      1           6</span>
<span class="co">#&gt;  7 6           0      0           6</span>
<span class="co">#&gt;  8 7           0      1           6</span>
<span class="co">#&gt;  9 8           0      0           6</span>
<span class="co">#&gt; 10 9           0      1           6</span>
<span class="co">#&gt; # … with 91 more rows</span></code></pre></div>
<p>And <code>redist</code> provides several useful plotting functions. By default, <code>plot</code> calls <code>hist</code>, which makes a histogram of a quantity of interest along with a reference line for each reference plan.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ggplots with nice defaults and labels</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">min_distr</span>, <span class="va">n_coalition</span><span class="op">)</span></code></pre></div>
<p><img src="tidy-redist_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">houston_plans</span>, <span class="va">pct_hisp</span>, type<span class="op">=</span><span class="st">"distr_qtys"</span><span class="op">)</span></code></pre></div>
<p><img src="tidy-redist_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<p>We can also re-index the plans back to the original, un-merged map.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston_orig_plans</span> <span class="op">=</span> <span class="fu"><a href="../reference/pullback.html">pullback</a></span><span class="op">(</span><span class="va">houston_plans</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">houston_orig_plans</span><span class="op">)</span>
<span class="co">#&gt; 100 sampled plans and 1 reference plan with 6 districts from a 937-unit map,</span>
<span class="co">#&gt;   drawn using Sequential Monte Carlo</span>
<span class="co">#&gt; With plans resampled from weights</span>
<span class="co">#&gt; Plans matrix: num [1:937, 1:101] 5 5 5 5 5 5 5 5 5 5 ...</span>
<span class="co">#&gt; # A tibble: 606 x 8</span>
<span class="co">#&gt;    draw  district    pop  comp pct_hisp pct_black pct_white pct_min</span>
<span class="co">#&gt;    &lt;fct&gt;    &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 &lt;ref&gt;        1 705967   874    0.273    0.0907     0.548   0.452</span>
<span class="co">#&gt;  2 &lt;ref&gt;        2 699765   874    0.271    0.107      0.509   0.491</span>
<span class="co">#&gt;  3 &lt;ref&gt;        3 697970   874    0.340    0.382      0.139   0.861</span>
<span class="co">#&gt;  4 &lt;ref&gt;        4 690022   874    0.344    0.405      0.201   0.799</span>
<span class="co">#&gt;  5 &lt;ref&gt;        5 701696   874    0.223    0.119      0.482   0.518</span>
<span class="co">#&gt;  6 &lt;ref&gt;        6 695465   874    0.729    0.0993     0.147   0.853</span>
<span class="co">#&gt;  7 1            1 683533   378    0.205    0.165      0.439   0.561</span>
<span class="co">#&gt;  8 1            2 714720   378    0.462    0.186      0.281   0.719</span>
<span class="co">#&gt;  9 1            3 721902   378    0.323    0.125      0.443   0.557</span>
<span class="co">#&gt; 10 1            4 667996   378    0.411    0.214      0.328   0.672</span>
<span class="co">#&gt; # … with 596 more rows</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">houston_orig_plans</span>, type<span class="op">=</span><span class="st">"plan"</span>, draw<span class="op">=</span><span class="fl">5</span>, geom<span class="op">=</span><span class="va">houston_area</span><span class="op">)</span></code></pre></div>
<p><img src="tidy-redist_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="all-together" class="section level1">
<h1 class="hasAnchor">
<a href="#all-together" class="anchor"></a>All Together</h1>
<p>A minimum working example for the ‘signature of gerrymandering’.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houston</span> <span class="op">=</span> <span class="va">texas_shp</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/redist_map.html">redist_map</a></span><span class="op">(</span>pop_tol<span class="op">=</span><span class="fl">0.05</span>, existing_col<span class="op">=</span><span class="va">cd</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cd</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">18</span>, <span class="fl">22</span>, <span class="fl">29</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># filter to Houston area</span>
    <span class="fu">mutate</span><span class="op">(</span>cd_cores <span class="op">=</span> <span class="fu"><a href="../reference/redist.identify.cores.html">make_cores</a></span><span class="op">(</span>within<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/merge_by.html">merge_by</a></span><span class="op">(</span><span class="va">cd_cores</span><span class="op">)</span>

<span class="va">houston_plans</span> <span class="op">=</span> <span class="fu"><a href="../reference/redist_smc.html">redist_smc</a></span><span class="op">(</span><span class="va">houston</span>, <span class="fl">100</span>, counties<span class="op">=</span><span class="va">county</span><span class="op">)</span> <span class="op">%&gt;%</span>    
    <span class="fu"><a href="../reference/add_reference.html">add_reference</a></span><span class="op">(</span><span class="va">houston</span><span class="op">$</span><span class="va">cd</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>pct_hisp <span class="op">=</span> <span class="fu"><a href="../reference/redist.group.percent.html">group_frac</a></span><span class="op">(</span><span class="va">houston</span>, <span class="va">hisp</span>, <span class="va">pop</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Sampling 100 475-unit maps with 6 districts and population between 663313 and 733136.</span>
<span class="co">#&gt; Ensuring no more than 5 splits of the 6 administrative units.</span>
<span class="co">#&gt; Making split 1 of 5</span>
<span class="co">#&gt; Using k = 7</span>
<span class="co">#&gt; Iteration     10 / 100</span>
<span class="co">#&gt; Iteration     20 / 100</span>
<span class="co">#&gt; Iteration     30 / 100</span>
<span class="co">#&gt; Iteration     40 / 100</span>
<span class="co">#&gt; Iteration     50 / 100</span>
<span class="co">#&gt; Iteration     60 / 100</span>
<span class="co">#&gt; Iteration     70 / 100</span>
<span class="co">#&gt; Iteration     80 / 100</span>
<span class="co">#&gt; Iteration     90 / 100</span>
<span class="co">#&gt; Iteration    100 / 100</span>
<span class="co">#&gt; 41.5% acceptance rate.</span>
<span class="co">#&gt; Resampling effective sample size: 98.4 (98.4% efficiency).</span>
<span class="co">#&gt; Making split 2 of 5</span>
<span class="co">#&gt; Using k = 8</span>
<span class="co">#&gt; Iteration     10 / 100</span>
<span class="co">#&gt; Iteration     20 / 100</span>
<span class="co">#&gt; Iteration     30 / 100</span>
<span class="co">#&gt; Iteration     40 / 100</span>
<span class="co">#&gt; Iteration     50 / 100</span>
<span class="co">#&gt; Iteration     60 / 100</span>
<span class="co">#&gt; Iteration     70 / 100</span>
<span class="co">#&gt; Iteration     80 / 100</span>
<span class="co">#&gt; Iteration     90 / 100</span>
<span class="co">#&gt; Iteration    100 / 100</span>
<span class="co">#&gt; 25.6% acceptance rate.</span>
<span class="co">#&gt; Resampling effective sample size: 98.6 (98.6% efficiency).</span>
<span class="co">#&gt; Making split 3 of 5</span>
<span class="co">#&gt; Using k = 7</span>
<span class="co">#&gt; Iteration     10 / 100</span>
<span class="co">#&gt; Iteration     20 / 100</span>
<span class="co">#&gt; Iteration     30 / 100</span>
<span class="co">#&gt; Iteration     40 / 100</span>
<span class="co">#&gt; Iteration     50 / 100</span>
<span class="co">#&gt; Iteration     60 / 100</span>
<span class="co">#&gt; Iteration     70 / 100</span>
<span class="co">#&gt; Iteration     80 / 100</span>
<span class="co">#&gt; Iteration     90 / 100</span>
<span class="co">#&gt; Iteration    100 / 100</span>
<span class="co">#&gt; 23.4% acceptance rate.</span>
<span class="co">#&gt; Resampling effective sample size: 96.5 (96.5% efficiency).</span>
<span class="co">#&gt; Making split 4 of 5</span>
<span class="co">#&gt; Using k = 6</span>
<span class="co">#&gt; Iteration     10 / 100</span>
<span class="co">#&gt; Iteration     20 / 100</span>
<span class="co">#&gt; Iteration     30 / 100</span>
<span class="co">#&gt; Iteration     40 / 100</span>
<span class="co">#&gt; Iteration     50 / 100</span>
<span class="co">#&gt; Iteration     60 / 100</span>
<span class="co">#&gt; Iteration     70 / 100</span>
<span class="co">#&gt; Iteration     80 / 100</span>
<span class="co">#&gt; Iteration     90 / 100</span>
<span class="co">#&gt; Iteration    100 / 100</span>
<span class="co">#&gt; 26.9% acceptance rate.</span>
<span class="co">#&gt; Resampling effective sample size: 93.3 (93.3% efficiency).</span>
<span class="co">#&gt; Making split 5 of 5</span>
<span class="co">#&gt; Using k = 4</span>
<span class="co">#&gt; Iteration     10 / 100</span>
<span class="co">#&gt; Iteration     20 / 100</span>
<span class="co">#&gt; Iteration     30 / 100</span>
<span class="co">#&gt; Iteration     40 / 100</span>
<span class="co">#&gt; Iteration     50 / 100</span>
<span class="co">#&gt; Iteration     60 / 100</span>
<span class="co">#&gt; Iteration     70 / 100</span>
<span class="co">#&gt; Iteration     80 / 100</span>
<span class="co">#&gt; Iteration     90 / 100</span>
<span class="co">#&gt; Iteration    100 / 100</span>
<span class="co">#&gt; 4.6% acceptance rate.</span>
<span class="co">#&gt; Resampling effective sample size: 96.5 (96.5% efficiency).</span>

<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">houston_plans</span>, type<span class="op">=</span><span class="st">"distr_qtys"</span>, <span class="va">pct_hisp</span><span class="op">)</span></code></pre></div>
<p><img src="tidy-redist_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>McCartan, C., &amp; Imai, K. (2020). Sequential Monte Carlo for Sampling Balanced and Compact Redistricting Plans. Available at <a href="https://imai.fas.harvard.edu/research/files/SMCredist.pdf" class="uri">https://imai.fas.harvard.edu/research/files/SMCredist.pdf</a>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ben Fifield, Christopher T. Kenny, Cory McCartan, Jun Kawahara, Kosuke Imai.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
